((i,l)=>{function o(){}function c(t){let e=t.offsetLeft,i=t.offsetTop;return t.offsetParent&&(t=arguments.callee(t.offsetParent),e+=t.x,i+=t.y),{x:e,y:i}}let d=l.body,r=l.querySelector.bind(l),n=l.querySelectorAll.bind(l),e=r("html"),s=r("#gotop"),a=r("#menu"),h=r("#main"),u=r("#header"),f=r("#mask"),t=r("#menu-toggle"),g=r("#menu-off"),m=r(".header-title"),v=r("#loading"),L=-1!==location.href.indexOf("post"),p=i.requestAnimationFrame,w=Array.prototype.forEach,y=/micromessenger/i.test(navigator.userAgent),$="ontouchstart"in i&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",x=l.documentElement,E=(600<i.innerWidth?(-1<window.navigator.userAgent.indexOf("WOW")||-1<window.navigator.userAgent.indexOf("Edge")||-1<window.navigator.userAgent.indexOf("MSIE"))&&-1===window.navigator.userAgent.indexOf("Trident")&&(x=d):-1<window.navigator.userAgent.indexOf("Android")&&-1<window.navigator.userAgent.indexOf("Browser")&&(x=d),{goTop:function(t){var e=x.scrollTop,i=2<arguments.length?arguments[1]:Math.abs(e-t)/12;e&&t<e?(x.scrollTop=Math.max(e-i,0),p(arguments.callee.bind(this,t,i))):t&&e<t?(x.scrollTop=Math.min(e+i,t),p(arguments.callee.bind(this,t,i))):this.toc.actived(t)},toggleGotop:function(t){t>i.innerHeight/2?s.classList.add("in"):s.classList.remove("in")},toggleMenu:function(t){t?(a.classList.remove("hide"),L||(h.classList.remove("menuoff"),jQuery(m).animate({marginRight:"-20%"})),i.innerWidth<1241&&(f.classList.add("in"),a.classList.add("show"),y?(t=x.scrollTop,h.classList.add("lock"),h.scrollTop=t):e.classList.add("lock"))):(f.classList.remove("in"),a.classList.remove("show"),y?(t=h.scrollTop,h.classList.remove("lock"),x.scrollTop=t):e.classList.remove("lock"))},fixedHeader:function(t){t>u.clientHeight?u.classList.add("fixed"):u.classList.remove("fixed")},toc:(()=>{let s=r("#post-toc");if(!s||!s.children.length)return L&&h.classList.add("show"),{fixed:o,actived:o};let e=r(".post-header").clientHeight,n=u.clientHeight,a=r("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");return s.querySelector(`a[href="#${a[0].id}"]`).parentNode.classList.add("active"),h.classList.add("tocshow"),m.classList.add("toc"),r(".footer").classList.add("toc"),{fixed:function(t){t>=e-n?s.classList.add("fixed"):s.classList.remove("fixed")},actived:function(i){for(let t=0,e=a.length;t<e;t++)i>c(a[t]).y-n-5&&(s.querySelector("li.active").classList.remove("active"),s.querySelector(`a[href="#${a[t].id}"]`).parentNode.classList.add("active"));i<c(a[0]).y&&(s.querySelector("li.active").classList.remove("active"),s.querySelector(`a[href="#${a[0].id}"]`).parentNode.classList.add("active"))}}})(),hideOnMask:[],modal:function(t){this.$modal=r(t),this.$off=this.$modal.querySelector(".close");let e=this;this.show=function(){f.classList.add("in"),800<i.innerWidth&&(h.classList.add("Mask"),a.classList.add("Mask")),e.$modal.classList.add("ready"),setTimeout(function(){e.$modal.classList.add("in")},0)},this.onHide=o,this.hide=function(){var t;e.onHide(),f.classList.remove("in"),800<i.innerWidth&&(h.classList.remove("Mask"),a.classList.remove("Mask"),t=l.querySelector(".imgShow"))&&document.body.removeChild(t),e.$modal.classList.remove("in"),setTimeout(function(){e.$modal.classList.remove("ready")},300)},this.toggle=function(){return e.$modal.classList.contains("in")?e.hide():e.show()},E.hideOnMask.push(this.hide),this.$off&&this.$off.addEventListener($,this.hide)},share:function(){let e=r("#pageShare"),i=r("#shareFab"),t=new this.modal("#globalShare"),s=(i&&(i.addEventListener($,function(){e.classList.toggle("in")},!1),l.addEventListener($,function(t){i.contains(t.target)||e.classList.remove("in")},!1)),new this.modal("#wxShare"));s.onHide=t.hide,w.call(n(".wxFab"),function(t){t.addEventListener($,s.toggle)})},reward:function(){let t=new this.modal("#reward"),e=r("#rewardCode"),i=r("#rewardToggle"),s=!1,n=-1,a=r(".wechatPay"),o=r(".alipayPay"),c=r(".icon-caret-up");r("#rewardBtn").addEventListener($,function(){-1===n?e.src=e.dataset.img:1===n?e.src=i.dataset.alipay:0===n&&(e.src=i.dataset.wechat),t.toggle()}),a.addEventListener("click",function(){s=!0}),i&&i.addEventListener("change",function(){n=this.checked?s?(e.src=this.dataset.wechat,o.classList.remove("show"),a.classList.add("show"),c.style="margin-left:-20%;",0):(e.src=this.dataset.alipay,o.classList.add("show"),a.classList.remove("show"),c.style="margin-left:20%;",this.checked=!1,1):(e.src=this.dataset.alipay,o.classList.add("show"),a.classList.remove("show"),c.style="margin-left:20%;",1)})},tabBar:function(t){t.parentNode.parentNode.classList.toggle("expand")},page:(()=>{let t=n(".fade, .fade-scale"),e=!1;return{loaded:function(){w.call(t,function(t){t.classList.add("in")}),e=!0},unload:function(){w.call(t,function(t){t.classList.remove("in")}),e=!1},visible:e}})(),lightbox:void w.call(n(".img-lightbox"),function(t){new T(t)}),loadScript:function(t){t.forEach(function(t){var e=l.createElement("script");e.src=t,e.async=!0,d.appendChild(e)})}});function T(t){this.$img=t.querySelector("img"),this.$overlay=t.querySelector("overlay"),this.margin=40,this.title=this.$img.title||this.$img.alt||"",this.isZoom=!1;let n,a,o,c,r,e=(this.calcRect=function(){c=d.clientWidth;var t=(r=d.clientHeight)-2*this.margin,e=n,i=a,s=(this.margin,e>c?c/e:1),s=Math.min(s,t<i?t/i:1);return{w:e*=s,h:i*=s,t:(r-i)/2-o.top,l:(c-e)/2-o.left+this.$img.offsetLeft}},this.setImgRect=function(t){this.$img.style.cssText=`width: ${t.w}px; max-width: ${t.w}px; height:${t.h}px; top: ${t.t}px; left: ${t.l}px`},this.setFrom=function(){this.setImgRect({w:o.width,h:o.height,t:0,l:(t.offsetWidth-o.width)/2})},this.setTo=function(){this.setImgRect(this.calcRect())},this.addTitle=function(){this.title&&(this.$caption=l.createElement("div"),this.$caption.innerHTML=this.title,this.$caption.className="overlay-title",t.appendChild(this.$caption))},this.removeTitle=function(){this.$caption&&t.removeChild(this.$caption)},this);this.zoomIn=function(){n=this.$img.naturalWidth||this.$img.width,a=this.$img.naturalHeight||this.$img.height,o=this.$img.getBoundingClientRect(),t.style.height=o.height+"px",t.classList.add("ready"),this.setFrom(),this.addTitle(),this.$img.classList.add("zoom-in"),setTimeout(function(){t.classList.add("active"),e.setTo(),e.isZoom=!0},0)},this.zoomOut=function(){this.isZoom=!1,t.classList.remove("active"),this.$img.classList.add("zoom-in"),this.setFrom(),setTimeout(function(){e.$img.classList.remove("zoom-in"),e.$img.style.cssText="",e.removeTitle(),t.classList.remove("ready"),t.removeAttribute("style")},300)},t.addEventListener("click",function(t){e.isZoom?e.zoomOut():"IMG"===t.target.tagName&&e.zoomIn()}),l.addEventListener("scroll",function(){e.isZoom&&e.zoomOut()}),i.addEventListener("resize",function(){e.isZoom&&e.zoomOut()})}i.addEventListener("load",function(){v.classList.remove("active"),E.page.loaded(),i.lazyScripts&&i.lazyScripts.length&&E.loadScript(i.lazyScripts)}),i.addEventListener("DOMContentLoaded",function(){var t=x.scrollTop;E.toc.fixed(t),E.toc.actived(t),E.page.loaded()});let O=!1;var k=r('a[href^="mailto"]');k&&k.addEventListener($,function(){O=!0}),i.addEventListener("beforeunload",function(){O?O=!1:E.page.unload()}),i.addEventListener("pageshow",function(){E.page.visible||E.page.loaded()}),i.addEventListener("resize",function(){$="ontouchstart"in i?"touchstart":"click",i.BLOG.even=$,E.toggleMenu()}),s.addEventListener($,function(){p(E.goTop.bind(E,0))},!1),t.addEventListener($,function(t){E.toggleMenu(!0),t.preventDefault()},!1),g.addEventListener($,function(){a.classList.add("hide"),L||(h.classList.add("menuoff"),jQuery(m).animate({marginRight:"-3%"}))},!1),f.addEventListener($,function(t){E.toggleMenu(),E.hideOnMask.forEach(function(t){t()}),t.preventDefault()},!1),l.addEventListener("scroll",function(){var t=x.scrollTop;E.toggleGotop(t),E.fixedHeader(t),E.toc.fixed(t),E.toc.actived(t)},!1),i.BLOG.SHARE&&L&&E.share(),i.BLOG.REWARD&&E.reward(),E.noop=o,E.even=$,E.$=r,E.$$=n,Object.keys(E).reduce(function(t,e){return t[e]=E[e],t},i.BLOG),i.Waves?(Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])):console.error("Waves loading failed.")})(window,document),function(){let s=window||this,e=s.BLOG.even,t=s.BLOG.$,i=t("#search"),n=t("#search-wrap"),a=t("#key"),o=t("#back"),c=t("#search-panel"),r=t("#search-result"),l=t("#search-tpl").innerHTML,d=(s.BLOG.ROOT+"/content.json").replace(/\/{2}/g,"/"),h;let u=t("html"),f={show:function(){s.innerWidth<760&&u.classList.add("lock-size"),c.classList.add("in")},hide:function(){s.innerWidth<760&&u.classList.remove("lock-size"),c.classList.remove("in")}};function g(t){let e="";e=t.length?t.map(function(t){return e=l,i={title:t.title,path:(s.BLOG.ROOT+"/"+t.path).replace(/\/{2,}/g,"/"),date:new Date(t.date).toLocaleDateString(),tags:t.tags.map(function(t){return`<span>#${t.name}</span>`}).join("")},e.replace(/\{\w+\}/g,function(t){t=t.replace(/\{|\}/g,"");return i[t]||""});var e,i}).join(""):'<li class="tips"><i class="icon icon-coffee icon-3x"></i><p>Results not found!</p></li>',r.innerHTML=e}function m(t,e){return e.lastIndex=0,e.test(t)}function v(t){var e,s=this.value.trim();if(s){let i=new RegExp(s.replace(/[ ]/g,"|"),"gmi");e=function(t){g(t.filter(function(t){return t=t,e=i,m(t.title,e)||t.tags.some(function(t){return m(t.name,e)})||m(t.text,e);var e})),f.show()},h?e(h):((s=new XMLHttpRequest).open("GET",d,!0),s.onload=function(){var t;200<=this.status&&this.status<300?(t=JSON.parse(this.response),h=t instanceof Array?t:t.posts,e(h)):console.error(this.statusText)},s.onerror=function(){console.error(this.statusText)},s.send()),t.preventDefault()}}i.addEventListener(e,function(){n.classList.toggle("in"),a.value="",n.classList.contains("in")?a.focus():a.blur()}),o.addEventListener(e,function(){n.classList.remove("in"),f.hide()}),document.addEventListener(e,function(t){"key"!==t.target.id&&"click"===e&&f.hide()}),a.addEventListener("input",v),a.addEventListener(e,v)}.call(this);